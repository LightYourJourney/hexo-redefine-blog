export default function imageViewer(){let r=!1,a=1,n=!1,s=!1,i=0,l=0,o=0,d=0,c=0,t=document.querySelector(".image-viewer-container"),m=t.querySelector("img"),v=e=>{document.body.style.overflow=e?"hidden":"auto",e?t.classList.add("active"):t.classList.remove("active")};let u=0;var e=e=>{n&&e.stopPropagation(),n=!1,m.style.cursor="grab"};m.addEventListener("wheel",e=>{e.preventDefault();var t=m.getBoundingClientRect(),r=e.clientX-t.left-t.width/2,t=e.clientY-t.top-t.height/2,n=a;a+=-.001*e.deltaY,n<(a=Math.min(Math.max(.8,a),4))?(d-=r*(a-n),c-=t*(a-n)):(d=0,c=0),m.style.transform=`translate(${d}px, ${c}px) scale(${a})`},{passive:!1}),m.addEventListener("mousedown",e=>{e.preventDefault(),n=!0,l=e.clientX,o=e.clientY,m.style.cursor="grabbing"},{passive:!1}),m.addEventListener("mousemove",e=>{var t,r;!n||(t=(new Date).getTime())-u<100||(u=t,t=e.clientX-l,r=e.clientY-o,d+=t,c+=r,l=e.clientX,o=e.clientY,m.style.transform=`translate(${d}px, ${c}px) scale(${a})`,s=!0)},{passive:!1}),m.addEventListener("mouseup",e,{passive:!1}),m.addEventListener("mouseleave",e,{passive:!1}),t.addEventListener("click",e=>{s||(r=!1,v(r),a=1,d=0,c=0,m.style.transform=`translate(${d}px, ${c}px) scale(${a})`),s=!1});let p=document.querySelectorAll(".markdown-body img, .masonry-item img, #shuoshuo-content img"),y=e=>{"Escape"===e.key&&r&&(r=!1,v(r),a=1,d=0,c=0,m.style.transform=`translate(${d}px, ${c}px) scale(${a})`,document.removeEventListener("keydown",y))};p.forEach((e,t)=>{e.addEventListener("click",()=>{i=t,r=!0,v(r),m.src=e.src,document.addEventListener("keydown",y)})});document.addEventListener("keydown",t=>{if(r){if("ArrowUp"===t.key||"ArrowLeft"===t.key)i=(i-1+p.length)%p.length;else{if("ArrowDown"!==t.key&&"ArrowRight"!==t.key)return;i=(i+1)%p.length}t=p[i];let e=t.src;t.hasAttribute("lazyload")&&(e=t.getAttribute("data-src"),t.src=e,t.removeAttribute("lazyload")),m.src=e}}),!p.length&&t&&t.parentNode.removeChild(t)}